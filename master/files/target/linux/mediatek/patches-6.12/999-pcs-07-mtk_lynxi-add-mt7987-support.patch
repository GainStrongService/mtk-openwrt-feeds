From 55a88a16aa8fc848967fbcad48760fe2a7d76f7f Mon Sep 17 00:00:00 2001
From: Bo-Cun Chen <bc-bocun.chen@mediatek.com>
Date: Thu, 18 Sep 2025 16:29:25 +0800
Subject: [PATCH] net: pcs: mtk_lynxi add mt7987 support

Signed-off-by: Bo-Cun Chen <bc-bocun.chen@mediatek.com>
---
 drivers/net/pcs/pcs-mtk-lynxi.c | 10 +++++++---
 1 file changed, 7 insertions(+), 3 deletions(-)

diff --git a/drivers/net/pcs/pcs-mtk-lynxi.c b/drivers/net/pcs/pcs-mtk-lynxi.c
index 9cfa6fe..c65f55b 100644
--- a/drivers/net/pcs/pcs-mtk-lynxi.c
+++ b/drivers/net/pcs/pcs-mtk-lynxi.c
@@ -474,9 +474,12 @@ static int mtk_pcs_lynxi_probe(struct platform_device *pdev)
 	else if (of_property_read_bool(np->parent, "mediatek,pnswap-rx"))
 		flags |= MTK_SGMII_FLAG_PN_SWAP_RX;
 
-	mpcs->rstc = of_reset_control_get_shared(np->parent, NULL);
-	if (IS_ERR(mpcs->rstc))
-		return PTR_ERR(mpcs->rstc);
+	if (of_parse_phandle(np->parent, "resets", 0)) {
+		mpcs->rstc = of_reset_control_get_shared(np->parent, NULL);
+		if (IS_ERR(mpcs->rstc))
+			return PTR_ERR(mpcs->rstc);
+	} else
+		mpcs->rstc = NULL;
 
 	reset_control_deassert(mpcs->rstc);
 	mpcs->sgmii_sel = devm_clk_get_enabled(dev, "sgmii_sel");
@@ -530,6 +533,7 @@ static void mtk_pcs_lynxi_remove(struct platform_device *pdev)
 }
 
 static const struct of_device_id mtk_pcs_lynxi_of_match[] = {
+	{ .compatible = "mediatek,mt7987-sgmii", .data = (void *)MTK_NETSYS_V3_AMA_RGC3 },
 	{ .compatible = "mediatek,mt7988-sgmii", .data = (void *)MTK_NETSYS_V3_AMA_RGC3 },
 	{ /* sentinel */ },
 };
-- 
2.45.2

