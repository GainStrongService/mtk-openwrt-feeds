--- a/target/linux/mediatek/image/Makefile
+++ b/target/linux/mediatek/image/Makefile
@@ -51,7 +51,18 @@ define Build/append-opteenode
 		$(if $(CONFIG_OPTEE_CORE_RESERVED_SHMEM),+ $(CONFIG_OPTEE_RESERVED_SHMEM_SIZE),))))
 endef
 
+# build squashfs-hashed
+define Build/squashfs-hashed
+	$(TOPDIR)/scripts/make-squashfs-hashed.sh \
+		$(ROOTFS/squashfs/$(DEVICE_NAME)) \
+		$(STAGING_DIR_HOSTPKG) \
+		$(ROOTFS/squashfs/$(DEVICE_NAME))-hashed-summary
+	fdt-patch-dm-verify $(ROOTFS/squashfs/$(DEVICE_NAME))-hashed-summary \
+		$(KDIR)/image-$(firstword $(DEVICE_DTS)).dtb $(KDIR)/image-$(firstword $(DEVICE_DTS)).dtb
+endef
+
 define Build/secure-boot
+	$(if $(CONFIG_MTK_SECURE_BOOT),$(call Build/squashfs-hashed))
 	$(if $(filter-out mt7987%, $(DEVICE_DTS)), \
 		$(if $(CONFIG_PACKAGE_optee-mediatek),$(call Build/append-opteenode)))
 endef
