From a1a92dd026b8d6cc8cfb6408c709a0093221cd89 Mon Sep 17 00:00:00 2001
From: Allen Ye <allen.ye@mediatek.com>
Date: Thu, 23 May 2024 11:07:25 +0800
Subject: [PATCH 089/236] mtk: hostapd: Remove BPCC and ML ie in per-sta
 profile of ML probe response

wifi7 cert testplan request DUT do not bring BPCC in STA info of
per-sta profile of ML probe response.
The standard defined not bring ML ie in per-sta profile.

Signed-off-by: Allen Ye <allen.ye@mediatek.com>
---
 src/ap/ieee802_11_eht.c | 4 +---
 1 file changed, 1 insertion(+), 3 deletions(-)

diff --git a/src/ap/ieee802_11_eht.c b/src/ap/ieee802_11_eht.c
index ccb188f98..ee3ea46b4 100644
--- a/src/ap/ieee802_11_eht.c
+++ b/src/ap/ieee802_11_eht.c
@@ -637,7 +637,6 @@ u8 * hostapd_eid_eht_basic_ml_common(struct hostapd_data *hapd,
 			len = link->resp_sta_profile_len;
 
 			slice_len = 255 - sta_info_len;
-
 			wpabuf_put_data(buf, ptr, slice_len);
 			len -= slice_len;
 			ptr += slice_len;
@@ -856,7 +855,7 @@ static size_t hostapd_eid_eht_ml_len(struct mld_info *info,
 	for (link_id = 0; info && link_id < ARRAY_SIZE(info->links);
 	     link_id++) {
 		struct mld_link_info *link;
-		size_t sta_len = EHT_ML_STA_INFO_LEN;
+		size_t sta_len = include_mld_id ? 21 : 22;
 
 		link = &info->links[link_id];
 		if (!link->valid)
@@ -886,7 +885,6 @@ static size_t hostapd_eid_eht_ml_len(struct mld_info *info,
 	return len;
 }
 #undef EHT_ML_COMMON_INFO_LEN
-#undef EHT_ML_STA_INFO_LEN
 
 
 u8 * hostapd_eid_eht_ml_beacon(struct hostapd_data *hapd,
-- 
2.45.2

