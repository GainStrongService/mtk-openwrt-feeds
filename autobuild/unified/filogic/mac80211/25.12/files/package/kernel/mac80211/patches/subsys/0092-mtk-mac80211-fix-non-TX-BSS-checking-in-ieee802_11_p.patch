From bbdb5af1071c2e9a0c411b17c28d56190dbf2130 Mon Sep 17 00:00:00 2001
From: Shayne Chen <shayne.chen@mediatek.com>
Date: Wed, 16 Apr 2025 16:47:12 +0800
Subject: [PATCH 092/128] mtk: mac80211: fix non-TX BSS checking in
 ieee802_11_parse_elems_full()

Signed-off-by: Shayne Chen <shayne.chen@mediatek.com>
---
 net/mac80211/parse.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/net/mac80211/parse.c b/net/mac80211/parse.c
index bfc4ecb7..cb672bba 100644
--- a/net/mac80211/parse.c
+++ b/net/mac80211/parse.c
@@ -1052,7 +1052,7 @@ ieee802_11_parse_elems_full(struct ieee80211_elems_parse_params *params)
 	 * In any case, we only look for one at a time, as encoded by
 	 * the WARN_ON above.
 	 */
-	if (params->bss) {
+	if (params->bss && params->bss->transmitted_bss) {
 		int nontx_len =
 			ieee802_11_find_bssid_profile(params->start,
 						      params->len,
-- 
2.45.2

