From 28819c79909b1f4debcf279a7b6264818f9112bc Mon Sep 17 00:00:00 2001
From: Michael-CY Lee <michael-cy.lee@mediatek.com>
Date: Tue, 21 Oct 2025 11:16:03 +0800
Subject: [PATCH 227/254] mtk: hostapd: add support to config setband_mask via
 ucode for STA interface

Signed-off-by: Michael-CY Lee <michael-cy.lee@mediatek.com>
---
 wpa_supplicant/ucode.c | 16 ++++++++++++++++
 1 file changed, 16 insertions(+)

diff --git a/wpa_supplicant/ucode.c b/wpa_supplicant/ucode.c
index 17d454d68..e0ecfa30a 100644
--- a/wpa_supplicant/ucode.c
+++ b/wpa_supplicant/ucode.c
@@ -588,6 +588,22 @@ uc_wpas_iface_config(uc_vm_t *vm, size_t nargs)
 			wpa_s->conf->freq_list = freq_list;
 			ret = ucv_boolean_new(true);
 		}
+	} else if (!strcmp(name, "mld_assoc_band")) {
+		if (!get) {
+			char *band = ucv_string_get(val);
+			wpa_printf(MSG_INFO, "mtk: ucode: Set band mask to %s\n", band);
+			if (!strcmp(band, "2g")) {
+				wpa_s->setband_mask = WPA_SETBAND_2G;
+			} else if (!strcmp(band, "5g")) {
+				wpa_s->setband_mask = WPA_SETBAND_5G;
+			} else if (!strcmp(band, "6g")) {
+				wpa_s->setband_mask = WPA_SETBAND_6G;
+			} else {
+				wpa_printf(MSG_ERROR, "mtk: ucode: Invalid band %s\n", band);
+				ret = ucv_boolean_new(false);
+			}
+			ret = ucv_boolean_new(true);
+		}
 	}
 
 	return ret;
-- 
2.45.2

