--- a/net/netfilter/xt_FLOWOFFLOAD.c
+++ b/net/netfilter/xt_FLOWOFFLOAD.c
@@ -556,7 +556,8 @@ static int nf_dev_forward_path(struct sk
 	route->tuple[!dir].in.num_encaps = info.num_encaps;
 	route->tuple[!dir].in.ingress_vlans = info.ingress_vlans;
 
-	if (info.xmit_type == FLOW_OFFLOAD_XMIT_DIRECT) {
+	if (info.xmit_type == FLOW_OFFLOAD_XMIT_DIRECT &&
+	    route->tuple[dir].xmit_type != FLOW_OFFLOAD_XMIT_XFRM) {
 		memcpy(route->tuple[dir].out.h_source, info.h_source, ETH_ALEN);
 		memcpy(route->tuple[dir].out.h_dest, info.h_dest, ETH_ALEN);
 		route->tuple[dir].out.ifindex = info.outdev->ifindex;
@@ -602,14 +603,11 @@ xt_flowoffload_route_routing(struct sk_b
 	nf_default_forward_path(route, this_dst, dir, devs);
 	nf_default_forward_path(route, other_dst, !dir, devs);
 
-	if (route->tuple[dir].xmit_type == FLOW_OFFLOAD_XMIT_NEIGH &&
-	    route->tuple[!dir].xmit_type == FLOW_OFFLOAD_XMIT_NEIGH) {
-		if (nf_dev_forward_path(skb, route, ct, dir, devs) ||
-		    nf_dev_forward_path(skb, route, ct, !dir, devs)) {
-			dst_release(route->tuple[dir].dst);
-			dst_release(route->tuple[!dir].dst);
-			return -ENOENT;
-		}
+	if (nf_dev_forward_path(skb, route, ct, dir, devs) ||
+	    nf_dev_forward_path(skb, route, ct, !dir, devs)) {
+		dst_release(route->tuple[dir].dst);
+		dst_release(route->tuple[!dir].dst);
+		return -ENOENT;
 	}
 
 	return 0;
